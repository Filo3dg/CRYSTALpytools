<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>CRYSTALpytools.thermodynamics module &mdash; CRYSTALpytools 2023.04.04 documentation</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="_static/doctools.js"></script>
        <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="CRYSTALpytools.plot module" href="crystalpytools.plot.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            CRYSTALpytools
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="introduction.html#installation">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="introduction.html#examples-and-tutorials">Examples and Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="introduction.html#usage">Usage</a></li>
<li class="toctree-l1"><a class="reference internal" href="introduction.html#testing">Testing</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="crystalpytools.html">Module-specific Docs</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="crystalpytools.html#submodules">Submodules</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="crystalpytools.adsorb.html">CRYSTALpytools.adsorb module</a></li>
<li class="toctree-l3"><a class="reference internal" href="crystalpytools.calculate.html">CRYSTALpytools.calculate module</a></li>
<li class="toctree-l3"><a class="reference internal" href="crystalpytools.convert.html">CRYSTALpytools.convert module</a></li>
<li class="toctree-l3"><a class="reference internal" href="crystalpytools.crystal_io.html">CRYSTALpytools.crystal_io module</a></li>
<li class="toctree-l3"><a class="reference internal" href="crystalpytools.execute.html">CRYSTALpytools.execute module</a></li>
<li class="toctree-l3"><a class="reference internal" href="crystalpytools.plot.html">CRYSTALpytools.plot module</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">CRYSTALpytools.thermodynamics module</a></li>
</ul>
</li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">CRYSTALpytools</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="crystalpytools.html">CRYSTALpytools Package</a></li>
      <li class="breadcrumb-item active">CRYSTALpytools.thermodynamics module</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/crystalpytools.thermodynamics.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="module-CRYSTALpytools.thermodynamics">
<span id="crystalpytools-thermodynamics-module"></span><h1>CRYSTALpytools.thermodynamics module<a class="headerlink" href="#module-CRYSTALpytools.thermodynamics" title="Permalink to this heading"></a></h1>
<p>A post-processing module for DFT lattice dynamics by harmonic and quasiharmonic
approximations (HA/QHA).</p>
<dl class="py class">
<dt class="sig sig-object py" id="CRYSTALpytools.thermodynamics.Harmonic">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">Harmonic</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">temperature</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pressure</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">write_out</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filename</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'HA-thermodynamics.dat'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CRYSTALpytools.thermodynamics.Harmonic" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="crystalpytools.crystal_io.html#CRYSTALpytools.crystal_io.Crystal_output" title="CRYSTALpytools.crystal_io.Crystal_output"><code class="xref py py-class docutils literal notranslate"><span class="pre">Crystal_output</span></code></a></p>
<p>Inherited from the Crystal_output class and has thermodynamic-specific
attributes. Used for harmonic phonon calclulations. Harmonic object can be
defined by either a harmonic phonon calculation output file or manually set
the all the information (usually for QHA).</p>
<dl class="py method">
<dt class="sig sig-object py" id="CRYSTALpytools.thermodynamics.Harmonic._generate_structure">
<span class="sig-name descname"><span class="pre">_generate_structure</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">scelphono</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CRYSTALpytools.thermodynamics.Harmonic._generate_structure" title="Permalink to this definition"></a></dt>
<dd><p>Eliminate the influences of the keyword ‘SCELPHONO’ and generate the
PyMatGen Structure object of the actual cell used for phonon
calculation. Not a standalone method.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>scellphono</strong> (<em>Union</em><em>[</em><em>list</em><em>[</em><em>int</em><em>]</em><em>,</em><em>array</em><em>[</em><em>int</em><em>]</em><em>]</em>) – ndimension*ndimension or
3*3 matrix corresponds to the ‘SCELPHONO’ keyword.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>self.structure</strong> (<em>PyMatGen Structure</em>)</p></li>
<li><p><strong>self.natom</strong> (<em>int</em>)</p></li>
<li><p><strong>self.volume</strong> (<em>float</em>)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="CRYSTALpytools.thermodynamics.Harmonic._phonon_sumup">
<span class="sig-name descname"><span class="pre">_phonon_sumup</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">temperature</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">calculate_zp</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CRYSTALpytools.thermodynamics.Harmonic._phonon_sumup" title="Permalink to this definition"></a></dt>
<dd><p>Summing up inidival phonon modes at each q point. Translational modes
with frequencies = 0 are skipped. Not a standalone method. For
thermodynamics, use ‘self.thermodyanmics’
instead.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>temperature</strong> (<em>float</em>) – </p></li>
<li><p><strong>calculate_zp</strong> (<em>bool</em>) – Calculate zero-point energy or temperature
dependent properties.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>zp_energy</strong> (<em>array[float]</em>) – Zero-point energy at a q point. Returned
if <code class="docutils literal notranslate"><span class="pre">calculate_zp</span> <span class="pre">=</span> <span class="pre">True</span></code>.</p></li>
<li><p><strong>U_vib</strong> (<em>array[float]</em>) – Vibrational contribution to internal energy
at constant temperature and a q point. Returned if
<code class="docutils literal notranslate"><span class="pre">calculate_zp</span> <span class="pre">=</span> <span class="pre">False</span></code>.</p></li>
<li><p><strong>entropy</strong> (<em>array[float]</em>) – Entropy at constant temperature and a q
point. Returned if <code class="docutils literal notranslate"><span class="pre">calculate_zp</span> <span class="pre">=</span> <span class="pre">False</span></code>.</p></li>
<li><p><strong>C_v</strong> (<em>array[float]</em>) – Constant volume specific heat at constant
temperature and a q point. Returned if <code class="docutils literal notranslate"><span class="pre">calculate_zp</span> <span class="pre">=</span> <span class="pre">False</span></code>.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="CRYSTALpytools.thermodynamics.Harmonic.from_file">
<span class="sig-name descname"><span class="pre">from_file</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">output_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scelphono</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">read_eigenvector</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">auto_calc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CRYSTALpytools.thermodynamics.Harmonic.from_file" title="Permalink to this definition"></a></dt>
<dd><p>Generate the Harominc object from a HA output file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>output_name</strong> (<em>str</em>) – Name of the output file.</p></li>
<li><p><strong>scellphono</strong> (<em>Union</em><em>[</em><em>array</em><em>[</em><em>float</em><em>]</em><em>, </em><em>list</em><em>[</em><em>float</em><em>]</em><em>]</em><em>, </em><em>optional</em>) – Supercell manipulation matrix used for vibrational properties.
Should be the same as ‘SCELPHONO’ keyword in CRYSTAL input file.
By default a 1*1*1 ‘SCELPHONO’ is assumed.</p></li>
<li><p><strong>read_eigenvector</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to read eigenvectors from
the output.</p></li>
<li><p><strong>auto_calc</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to automatically launch
thermodynamic calculations. Parameters defined during
initialization will be used.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>self.strucrure</strong> (<em>PyMatGen Structure</em>) – Cell reduced by SCELPHONO.</p></li>
<li><p><strong>self.natom</strong> (<em>int</em>) – Number of atoms in the reduced cell.</p></li>
<li><p><strong>self.volume</strong> (<em>float</em>) – Volume of the reduced cell. Unit: Angstrom^3</p></li>
<li><p><strong>self.mode</strong> (<em>list[Mode]</em>) – List of mode objects at all the qpoints.</p></li>
</ul>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Exception</strong> – If computational data is stored in the object.</p></li>
<li><p><strong>Exception</strong> – If a QHA output file is read.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="CRYSTALpytools.thermodynamics.Harmonic.from_frequency">
<span class="sig-name descname"><span class="pre">from_frequency</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">edft</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">qpoint</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frequency</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eigenvector</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CRYSTALpytools.thermodynamics.Harmonic.from_frequency" title="Permalink to this definition"></a></dt>
<dd><p>Generate a Harmonic object by specifying frequency and eigenvector.
Not recommanded to be used as a standalone method.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>edft</strong> (<em>float</em>) – Electron total energy</p></li>
<li><p><strong>qpoint</strong> (<em>list</em><em>[</em><em>list</em><em>[</em><em>array</em><em>[</em><em>float</em><em>]</em><em>, </em><em>float</em><em>]</em><em>]</em>) – Fractional coordinate
and weight of qpoint</p></li>
<li><p><strong>frequency</strong> (<em>array</em><em>[</em><em>float</em><em>]</em>) – Array of frequencies. Unit: THz</p></li>
<li><p><strong>eigenvector</strong> (<em>array</em><em>[</em><em>float</em><em>]</em>) – Normalized eigenvectors.</p></li>
<li><p><strong>structure</strong> (<em>PyMatGen Structure</em><em>, </em><em>optional</em>) – </p></li>
<li><p><strong>natom</strong> (<em>int</em><em>, </em><em>optional</em>) – </p></li>
<li><p><strong>volume</strong> (<em>float</em><em>, </em><em>optional</em>) – </p></li>
</ul>
</dd>
</dl>
<p><strong>Note</strong>: The user should define either ‘structure’ or ‘natom’ + ‘volume’.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>self.nqpoint</strong> (<em>int</em>)</p></li>
<li><p><strong>self.nmode</strong> (<em>array[int]</em>)</p></li>
<li><p><strong>self.mode</strong> (<em>list[Mode]</em>)</p></li>
<li><p><strong>self.structure</strong> (<em>PyMatGen Structure, optional</em>)</p></li>
<li><p><strong>self.natom</strong> (<em>int</em>)</p></li>
<li><p><strong>self.volume</strong> (<em>float</em>)</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>Exception</strong> – If computational data is stored in the object.</p></li>
<li><p><strong>Exception</strong> – If the 1st dimension (nqpoint) of <code class="docutils literal notranslate"><span class="pre">qpoint</span></code> and <code class="docutils literal notranslate"><span class="pre">frequency</span></code> are not consistent.</p></li>
<li><p><strong>Exception</strong> – If the 2nd dimension (nfreq) of <code class="docutils literal notranslate"><span class="pre">frequency</span></code> and <code class="docutils literal notranslate"><span class="pre">eigenvector</span></code> are not consistent and <code class="docutils literal notranslate"><span class="pre">eigenvector</span></code> is not <code class="docutils literal notranslate"><span class="pre">[]</span></code>.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="CRYSTALpytools.thermodynamics.Harmonic.print_results">
<span class="sig-name descname"><span class="pre">print_results</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#CRYSTALpytools.thermodynamics.Harmonic.print_results" title="Permalink to this definition"></a></dt>
<dd><p>Print HA thermodynamic results into an external file. Used if
<code class="docutils literal notranslate"><span class="pre">write_out</span> <span class="pre">=</span> <span class="pre">True</span></code>.</p>
<p><strong>Note</strong></p>
<p>Phonon dispersions are forced to be summed to keep the output
succinct if the automatic scheme (write_out=True) is launched. To get
verbose outputs, directly call this method.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="CRYSTALpytools.thermodynamics.Harmonic.thermodynamics">
<span class="sig-name descname"><span class="pre">thermodynamics</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sumphonon</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mutewarning</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CRYSTALpytools.thermodynamics.Harmonic.thermodynamics" title="Permalink to this definition"></a></dt>
<dd><p>Calculate the thermodynamic properties (zp_energy, U_vib, entropy, C_v
and Helmholtz free energy) of the given system, at all qpoints and the
whole temperature range.</p>
<p>The Helmholtz free energy is defined as:</p>
<div class="math notranslate nohighlight">
\[F(p,V) = E_{DFT} + F_{vib}(T) = E_{DFT} + U_{vib}(T) - TS(T)\]</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>temperature</strong> (<em>Union</em><em>[</em><em>array</em><em>[</em><em>float</em><em>]</em><em>, </em><em>list</em><em>[</em><em>float</em><em>]</em><em>]</em><em>, </em><em>optional</em>) – Temperature. Unit: K</p></li>
<li><p><strong>pressure</strong> (<em>Union</em><em>[</em><em>array</em><em>[</em><em>float</em><em>]</em><em>, </em><em>list</em><em>[</em><em>float</em><em>]</em><em>]</em><em>, </em><em>optional</em>) – Pressure. Unit: GPa</p></li>
<li><p><strong>sumphonon</strong> (<em>bool</em>) – Whether to sum up the phonon contributions across
the sampled q points and take weighted-average.</p></li>
<li><p><strong>mutewarning</strong> (<em>bool</em>) – Whether print out warning messages of updated
temperature and pressure (For QHA).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>self.helmholtz</strong> (<em>array[float]</em>) – Helmholtz free energy
(nqpoint*ntemperature). Unit: KJ/mol</p></li>
<li><p><strong>self.gibbs</strong> (<em>array[float]</em>) – Gibbs free energy
(nqpoint*ntemperature*npressure). Unit: KJ/mol</p></li>
<li><p><strong>self.zp_energy</strong> (<em>array[float]</em>) – Zero-point energy. (nqpoint*1).
Unit: KJ/mol</p></li>
<li><p><strong>self.U_vib</strong> (<em>array[float]</em>) – Vibrational contribution to internal
energy (nqpoint*ntemperature). Unit: KJ/mol</p></li>
<li><p><strong>self.entropy</strong> (<em>array[float]</em>) – Entropy (nqpoint*ntemperature)
Unit: J/mol*K</p></li>
<li><p><strong>self.C_v</strong> (<em>array[float]</em>) – Constant volume specific heat
(nqpoint*ntemperature). Unit: J/mol*K</p></li>
</ul>
</dd>
</dl>
<p><strong>Note</strong>: If <code class="docutils literal notranslate"><span class="pre">sumphonon</span> <span class="pre">=</span> <span class="pre">True</span></code>, nqpoint = 1.</p>
<dl class="field-list simple">
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>ValueError</strong> – If temperature and pressure are defined neither here nor during initialization</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="CRYSTALpytools.thermodynamics.Mode">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">Mode</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rank</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frequency</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">volume</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eigenvector</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CRYSTALpytools.thermodynamics.Mode" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Store important information for a given vibrational mode and do analysis at
mode-level. Not recommanded to be used individually.</p>
<dl class="py method">
<dt class="sig sig-object py" id="CRYSTALpytools.thermodynamics.Mode.get_C_v">
<span class="sig-name descname"><span class="pre">get_C_v</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">temperature</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CRYSTALpytools.thermodynamics.Mode.get_C_v" title="Permalink to this definition"></a></dt>
<dd><p>Get the constant volume specific heat of a single mode with the
following equation. Limited to ncalc = 1 cases.</p>
<div class="math notranslate nohighlight">
\[C^{V}_{i,\mathbf{q}}=
\frac{\left(\hbar\omega_{i,\mathbf{q}}\right)^{2}}{k_{B}T^{2}}
\frac{\exp{
\left(
    \frac{\hbar\omega_{i,\mathbf{q}}}{k_{B}T}
\right)}
}{\left[
    \exp{\left(
        \frac{\hbar\omega_{i,\mathbf{q}}}{k_{B}T}
    \right)-1}
\right]^{2}
}\]</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>temperature</strong> (<em>float</em><em>, </em><em>optional</em>) – Unit: K</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>self.C_v</strong> (<em>float</em>) – Constant volume specific heat. Unit: J/mol*K</p>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>Exception</strong> – If <code class="docutils literal notranslate"><span class="pre">self.ncalc</span></code> &gt; 1.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="CRYSTALpytools.thermodynamics.Mode.get_U_vib">
<span class="sig-name descname"><span class="pre">get_U_vib</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">temperature</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">298.15</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CRYSTALpytools.thermodynamics.Mode.get_U_vib" title="Permalink to this definition"></a></dt>
<dd><p>Get the vibration contribution to internal energy (including zero-point
energy) of a single mode with the following equation. Limited to
ncalc = 1 cases.</p>
<div class="math notranslate nohighlight">
\[U^{vib}_{i,\mathbf{q}}\left(T\right)=E^{zp}_{i,\mathbf{q}}+
\frac{\hbar\omega_{i,\mathbf{q}}}{\exp{\left(
    \frac{\hbar\omega_{i,\mathbf{q}}}{k_{B}T}
\right)}-1}\]</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>temperature</strong> (<em>float</em><em>, </em><em>optional</em>) – Temperature where the quantity is
computed. Unit: K</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>self.U_vib</strong> (<em>float</em>) – Vibration contribution to internal energy.
Unit: KJ/mol</p>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>Exception</strong> – If <code class="docutils literal notranslate"><span class="pre">self.ncalc</span></code> &gt; 1.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="CRYSTALpytools.thermodynamics.Mode.get_entropy">
<span class="sig-name descname"><span class="pre">get_entropy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">temperature</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CRYSTALpytools.thermodynamics.Mode.get_entropy" title="Permalink to this definition"></a></dt>
<dd><p>Get the entropy of a single mode with the following equation. Limited
to ncalc = 1 cases.</p>
<div class="math notranslate nohighlight">
\[S_{i,\mathbf{q}}\left(T\right)=k_{B}\left\{
    \frac{\hbar\omega_{i,\mathbf{q}}}{k_{B}T\left[
        \exp{\left(
            \frac{\hbar\omega_{i,\mathbf{q}}}{k_{B}T}
        \right)}-1
    \right]}-\ln{\left[
        1-\exp{\left(
            -\frac{\hbar\omega_{i,\mathbf{q}}}{k_{B}T}
        \right)}
    \right]}
\right\}\]</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>temperature</strong> (<em>float</em><em>, </em><em>optional</em>) – Unit: K</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>self.entropy</strong> (<em>float</em>) – Entropy. Unit: J/mol*K</p>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>Exception</strong> – If <code class="docutils literal notranslate"><span class="pre">self.ncalc</span></code> &gt; 1.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="CRYSTALpytools.thermodynamics.Mode.get_zp_energy">
<span class="sig-name descname"><span class="pre">get_zp_energy</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#CRYSTALpytools.thermodynamics.Mode.get_zp_energy" title="Permalink to this definition"></a></dt>
<dd><p>Get the zero-point energy of a single mode with the following equation.
Limited to ncalc = 1 cases.</p>
<div class="math notranslate nohighlight">
\[E^{zp}_{i,\mathbf{q}}=\frac{1}{2}\hbar\omega_{i,\mathbf{q}}\]</div>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>self.zp_energy</strong> (<em>float</em>) – Zero-point energy. Unit: KJ/mol</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>Exception</strong> – If <code class="docutils literal notranslate"><span class="pre">self.ncalc</span></code> &gt; 1.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="CRYSTALpytools.thermodynamics.Mode.polynomial_fit">
<span class="sig-name descname"><span class="pre">polynomial_fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">eq_point</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">order</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[2,</span> <span class="pre">3]</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CRYSTALpytools.thermodynamics.Mode.polynomial_fit" title="Permalink to this definition"></a></dt>
<dd><p>Fit phonon frequency as the polynomial function of volume with
perturbation theory. Limited to ncalc &gt; 1 cases.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>eq_point</strong> (<em>int</em>) – The index (not rank) corresponds to the DFT total
energy minimum (typically the unstrained geometry).</p></li>
<li><p><strong>order</strong> (<em>Union</em><em>[</em><em>array</em><em>[</em><em>int</em><em>]</em><em>, </em><em>list</em><em>[</em><em>int</em><em>]</em><em>]</em><em>, </em><em>optional</em>) – Orders of
polynomials used.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>self.poly_fit</strong> (<em>Dict[int, NumPy Polynomial]</em>) – Key - orders of power,
Value - fitted NumPy polynomials</p></li>
<li><p><strong>self.poly_fit_rsquare</strong> (<em>Dict[int, float]</em>) – Key - orders of power,
Value - goodness of fittings, characterized by R^2.</p></li>
</ul>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>Exception</strong> – If <code class="docutils literal notranslate"><span class="pre">self.ncalc</span></code> &lt;= 1.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="CRYSTALpytools.thermodynamics.Quasi_harmonic">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">Quasi_harmonic</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">temperature</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pressure</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">write_out</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filename</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'QHA-Fit.dat'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CRYSTALpytools.thermodynamics.Quasi_harmonic" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Generate and rearrange harmonic phonons, store the fitted, volume-dependent
QHA phonon information and obtain the QHA thermodynamic properties.</p>
<dl class="py method">
<dt class="sig sig-object py" id="CRYSTALpytools.thermodynamics.Quasi_harmonic._combine_data">
<span class="sig-name descname"><span class="pre">_combine_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ha_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">overlap</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sort_phonon</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CRYSTALpytools.thermodynamics.Quasi_harmonic._combine_data" title="Permalink to this definition"></a></dt>
<dd><p>Combine the HA calculation data and rearrange it in the ascending order
of volumes. Not a standalone method.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ha_list</strong> (<em>list</em><em>[</em><a class="reference internal" href="#CRYSTALpytools.thermodynamics.Harmonic" title="CRYSTALpytools.thermodynamics.Harmonic"><em>Harmonic</em></a><em>]</em>) – List of harmonic objects.</p></li>
<li><p><strong>overlap</strong> (<em>float</em>) – </p></li>
<li><p><strong>sort_phonon</strong> (<em>bool</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>combined_phonon</strong> (<em>list[Harmonic]</em>)</p></li>
<li><p><strong>combined_volume</strong> (<em>list[float]</em>)</p></li>
<li><p><strong>combined_edft</strong> (<em>list[float]</em>)</p></li>
<li><p><strong>combined_mode</strong> (<em>list[Mode]</em>)</p></li>
</ul>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>Exception</strong> – If number of q points, modes or atoms are not consistent across the HA calculations.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="CRYSTALpytools.thermodynamics.Quasi_harmonic._get_harmonic_phonon">
<span class="sig-name descname"><span class="pre">_get_harmonic_phonon</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">volume</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CRYSTALpytools.thermodynamics.Quasi_harmonic._get_harmonic_phonon" title="Permalink to this definition"></a></dt>
<dd><p>Get numerical phonon frequencies from fitted analytical expressions and
generate harmonic phonon objects. Not a standalone method.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>volume</strong> (<em>float</em>) – Unit: Angstrom^3</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ha</strong> (<em>Harmonic</em>) – Harmonic phonon object with numerical data.</p>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>Exception</strong> – If frequency is not fitted as function of volumes.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="CRYSTALpytools.thermodynamics.Quasi_harmonic._minimize_gibbs">
<span class="sig-name descname"><span class="pre">_minimize_gibbs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">volume</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">temperature</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pressure</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CRYSTALpytools.thermodynamics.Quasi_harmonic._minimize_gibbs" title="Permalink to this definition"></a></dt>
<dd><p>Get Gibbs free energy from the Harmonic phonon object. Used only for
minimizing G(V; T, p) by SciPy. Not a standalone method.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>volume</strong> (<em>float</em>) – </p></li>
<li><p><strong>temperature</strong> (<em>float</em>) – </p></li>
<li><p><strong>pressure</strong> (<em>float</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ha.gibbs</strong> (<em>float</em>) – Gibbs free energy. Unit: KJ/mol</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="CRYSTALpytools.thermodynamics.Quasi_harmonic._phonon_continuity">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">_phonon_continuity</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">freq</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eigvt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">symm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">overlap</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.4</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CRYSTALpytools.thermodynamics.Quasi_harmonic._phonon_continuity" title="Permalink to this definition"></a></dt>
<dd><p>Rearrange phonon modes by their continuity. If the difference between
the maximum scalar product of corresponding eigenvectors (normalized to
1) and scalar products of other modes is less than 0.4, warning is
printed due to the potential overlap of modes. Adopted from CRYSTAL17.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ol class="upperalpha simple">
<li><p>Erba, <em>J. Chem. Phys.</em>, 2014, <strong>141</strong>, 124115.</p></li>
</ol>
</div>
<p>Not a standalone method.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>freq</strong> (<em>array</em><em>[</em><em>float</em><em>]</em>) – Phonon frequencies. Unit: THz</p></li>
<li><p><strong>eigvt</strong> (<em>array</em><em>[</em><em>float</em><em>]</em>) – Eigenvectores normalized to 1</p></li>
<li><p><strong>symm</strong> (<em>array</em><em>[</em><em>float</em><em>]</em>) – Sub-group numbers of corresponding modes.
<em>Not implemented</em></p></li>
<li><p><strong>overlap</strong> (<em>float</em>) – The threshold of close mode overlaps.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>freq</strong> (<em>array[float]</em>) – Sorted phonon frequencies</p></li>
<li><p><strong>eigvt</strong> (<em>array[float]</em>) – Sorted eigenvectores</p></li>
<li><p><strong>close_overlap</strong> (<em>array[bool]</em>) – ncalc*nmode*nmode. Whether close
overlap is identified between the previous calculation (2nd
dimension) and the current one (3rd).</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="CRYSTALpytools.thermodynamics.Quasi_harmonic.edft_eos_fit">
<span class="sig-name descname"><span class="pre">edft_eos_fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">method</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CRYSTALpytools.thermodynamics.Quasi_harmonic.edft_eos_fit" title="Permalink to this definition"></a></dt>
<dd><p>Fit electron total energy according to equation of states.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>method</strong> (<em>str</em>) – Name of EoS used. Consistent with
<a class="reference external" href="https://pymatgen.org/pymatgen.analysis.eos.html">PyMatGen</a>.</p></li>
<li><p><strong>order</strong> (<em>int</em>) – For the DeltaFactor method. <em>Not implemented</em></p></li>
<li><p><strong>min_ndata_factor</strong> (<em>int</em>) – For the NumericalEOS method. <em>Not implemented</em></p></li>
<li><p><strong>max_poly_order_factor</strong> (<em>int</em>) – For the NumericalEOS method. <em>Not implemented</em></p></li>
<li><p><strong>min_poly_order_factor</strong> (<em>int</em>) – For the NumericalEOS method. <em>Not implemented</em></p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>self.eos_method</strong> (<em>string</em>) – Name of the fitted equation of state</p></li>
<li><p><strong>self.eos</strong> (<em>PyMatGen EOS</em>) – The fitted equation of state.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="CRYSTALpytools.thermodynamics.Quasi_harmonic.freq_polynomial_fit">
<span class="sig-name descname"><span class="pre">freq_polynomial_fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">order</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CRYSTALpytools.thermodynamics.Quasi_harmonic.freq_polynomial_fit" title="Permalink to this definition"></a></dt>
<dd><p>Fit phonon frequencies as polynomial functions of volumes.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>order</strong> (<em>Union</em><em>[</em><em>list</em><em>[</em><em>int</em><em>]</em><em>, </em><em>array</em><em>[</em><em>int</em><em>]</em><em>]</em>) – The order of polynomials used.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>self.fit_order</strong> (<em>int</em>) – The optimal order of polynomial fit.</p>
</dd>
</dl>
<p>Please also refer to <code class="docutils literal notranslate"><span class="pre">self.poly_fit</span></code> and <code class="docutils literal notranslate"><span class="pre">self.poly_fit_rsquare</span></code>
attributes of Mode class.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="CRYSTALpytools.thermodynamics.Quasi_harmonic.from_HA_files">
<span class="sig-name descname"><span class="pre">from_HA_files</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_files</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scelphono</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">overlap</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sort_phonon</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CRYSTALpytools.thermodynamics.Quasi_harmonic.from_HA_files" title="Permalink to this definition"></a></dt>
<dd><p>Read data from individual HA calculation outputs.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input_files</strong> (<em>list</em><em>[</em><em>str</em><em>]</em>) – List of phonon output filenames.</p></li>
<li><p><strong>scelphono</strong> (<em>Union</em><em>[</em><em>array</em><em>[</em><em>float</em><em>]</em><em>, </em><em>list</em><em>[</em><em>float</em><em>]</em><em>]</em><em>, </em><em>optional</em>) – Corresponds
to the ‘SCELPHONO’ keyword in CRYSTAL. Either 3*3 or
ndimension*ndimension. By default a 1*1*1 ‘SCELPHONO’ is
assumed.</p></li>
<li><p><strong>overlap</strong> (<em>float</em><em>, </em><em>optional</em>) – The threshold of close mode overlaps.</p></li>
<li><p><strong>sort_phonon</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to check phonon continuity.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>self.ncalc</strong> (<em>int</em>) – Number of HA phonon calculations.</p></li>
<li><p><strong>self.combined_phonon</strong> (<em>list[Harmonic]</em>) – List of Harmonic objects.</p></li>
<li><p><strong>self.combined_volume</strong> (<em>list[float]</em>) – Volumes. Unit: Angstrom^3</p></li>
<li><p><strong>self.combined_edft</strong> (<em>list[float]</em>) – DFT total energies. Unit: KJ/mol</p></li>
<li><p><strong>self.combined_mode</strong> (<em>list[Mode]</em>) – List of mode objects.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="CRYSTALpytools.thermodynamics.Quasi_harmonic.from_QHA_file">
<span class="sig-name descname"><span class="pre">from_QHA_file</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scelphono</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">overlap</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sort_phonon</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CRYSTALpytools.thermodynamics.Quasi_harmonic.from_QHA_file" title="Permalink to this definition"></a></dt>
<dd><p>Read data from a single QHA calculation at Gamma point.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input_files</strong> (<em>Union</em><em>[</em><em>str</em><em>, </em><em>list</em><em>[</em><em>str</em><em>]</em><em>]</em>) – Only 1 QHA file is permitted.</p></li>
<li><p><strong>scelphono</strong> (<em>Union</em><em>[</em><em>array</em><em>[</em><em>float</em><em>]</em><em>, </em><em>list</em><em>[</em><em>float</em><em>]</em><em>]</em><em>, </em><em>optional</em>) – </p></li>
<li><p><strong>overlap</strong> (<em>float</em><em>, </em><em>optional</em>) – </p></li>
<li><p><strong>sort_phonon</strong> (<em>bool</em><em>, </em><em>optional</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>self.ncalc</strong> (<em>int</em>)</p></li>
<li><p><strong>self.combined_phonon</strong> (<em>list[Harmonic]</em>)</p></li>
<li><p><strong>self.combined_volume</strong> (<em>list[float]</em>)</p></li>
<li><p><strong>self.combined_edft</strong> (<em>list[float]</em>)</p></li>
<li><p><strong>self.combined_mode</strong> (<em>list[Mode]</em>)</p></li>
</ul>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>Exception</strong> – If multiple files are defined.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="CRYSTALpytools.thermodynamics.Quasi_harmonic.thermo_eos">
<span class="sig-name descname"><span class="pre">thermo_eos</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">eos_method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'birch_murnaghan'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">poly_order</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[2,</span> <span class="pre">3]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mutewarning</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CRYSTALpytools.thermodynamics.Quasi_harmonic.thermo_eos" title="Permalink to this definition"></a></dt>
<dd><p>Obtain thermodynamic properties by fitting EOS, which is fitted by the
Helmholtz free energies of sampled harmonic phonons. The explicit
sorting and fitting of frequency-volume relationship is disabled.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>eos_method</strong> (<em>str</em><em>, </em><em>optional</em>) – </p></li>
<li><p><strong>poly_order</strong> (<em>Union</em><em>[</em><em>array</em><em>[</em><em>int</em><em>]</em><em>, </em><em>list</em><em>[</em><em>int</em><em>]</em><em>]</em><em>, </em><em>optional</em>) – Order of
polynomials used to fit Gibbs free energy to get entropy.</p></li>
<li><p><strong>mutewarning</strong> (<em>bool</em><em>, </em><em>optional</em>) – </p></li>
<li><p><strong>temperature</strong> (<em>Union</em><em>[</em><em>array</em><em>[</em><em>float</em><em>]</em><em>, </em><em>list</em><em>[</em><em>float</em><em>]</em><em>]</em><em>, </em><em>optional</em>) – Unit: K</p></li>
<li><p><strong>pressure</strong> (<em>Union</em><em>[</em><em>array</em><em>[</em><em>float</em><em>]</em><em>, </em><em>list</em><em>[</em><em>float</em><em>]</em><em>]</em><em>, </em><em>optional</em>) – Unit: GPa</p></li>
<li><p><strong>order</strong> (<em>int</em><em>, </em><em>optional</em>) – For DeltaFactor EOS. <em>Not implemented</em></p></li>
<li><p><strong>min_ndata_factor</strong> (<em>int</em><em>, </em><em>optional</em>) – For Numerical EOS. <em>Not implemented</em></p></li>
<li><p><strong>max_poly_order_factor</strong> (<em>int</em><em>, </em><em>optional</em>) – For Numerical EOS. <em>Not implemented</em></p></li>
<li><p><strong>min_poly_order_factor</strong> (<em>int</em><em>, </em><em>optional</em>) – For Numerical EOS. <em>Not implemented</em></p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>self</strong> (<em>Quasi_harmonic</em>)</p>
</dd>
</dl>
<p>New Attributes are consistent with the <code class="docutils literal notranslate"><span class="pre">thermo_freq</span></code> method</p>
<dl class="field-list simple">
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Exception</strong> – If the number of HA calculations is less than 4.</p></li>
<li><p><strong>ValueError</strong> – If temperature or pressure is defined neither here nor during initialization.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="CRYSTALpytools.thermodynamics.Quasi_harmonic.thermo_freq">
<span class="sig-name descname"><span class="pre">thermo_freq</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">eos_method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'birch_murnaghan'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">poly_order</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[2,</span> <span class="pre">3]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'BFGS'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">volume_bound</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mutewarning</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CRYSTALpytools.thermodynamics.Quasi_harmonic.thermo_freq" title="Permalink to this definition"></a></dt>
<dd><p>Obtain thermodynamic properties by explicitly fitting phonon
frequencies as polynomial functions of volume. DFT total energies are
fitted as a function of volume by equation of states (EOS).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>eos_method</strong> (<em>str</em><em>, </em><em>optional</em>) – EOS used to fit DFT total energies.</p></li>
<li><p><strong>poly_order</strong> (<em>Union</em><em>[</em><em>array</em><em>[</em><em>int</em><em>]</em><em>, </em><em>list</em><em>[</em><em>int</em><em>]</em><em>]</em><em>, </em><em>optional</em>) – The order of
polynomials used to fit frequency as the function of volumes.</p></li>
<li><p><strong>min_method</strong> (<em>string</em><em>, </em><em>optional</em>) – Minimisation algorithms.</p></li>
<li><p><strong>volume_bound</strong> (<em>tuple-like</em><em>, </em><em>optional</em>) – equilibrium volumes. Unit: Angstrom^3</p></li>
<li><p><strong>mutewarning</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether print out warning messages.</p></li>
<li><p><strong>temperature</strong> (<em>array</em><em>[</em><em>float</em><em>]</em><em>, </em><em>optional</em>) – Unit: K</p></li>
<li><p><strong>pressure</strong> (<em>array</em><em>[</em><em>float</em><em>]</em><em>, </em><em>optional</em>) – Unit: GPa</p></li>
<li><p><strong>order</strong> (<em>int</em><em>, </em><em>optional</em>) – For DeltaFactor EOS. <em>Not implemented</em></p></li>
<li><p><strong>min_ndata_factor</strong> (<em>int</em><em>, </em><em>optional</em>) – For Numerical EOS. <em>Not implemented</em></p></li>
<li><p><strong>max_poly_order_factor</strong> (<em>int</em><em>, </em><em>optional</em>) – For Numerical EOS. <em>Not implemented</em></p></li>
<li><p><strong>min_poly_order_factor</strong> (<em>int</em><em>, </em><em>optional</em>) – For Numerical EOS. <em>Not implemented</em></p></li>
</ul>
</dd>
</dl>
<p><strong>Notes</strong></p>
<ol class="arabic simple">
<li><p>EOS supported by <code class="docutils literal notranslate"><span class="pre">eos_method</span></code> are consistent with <a class="reference external" href="https://pymatgen.org/pymatgen.analysis.eos.html">PyMatGen</a>.</p></li>
<li><dl class="simple">
<dt>Parameterized and tested algorithms for <code class="docutils literal notranslate"><span class="pre">min_method</span></code>:</dt><dd><ul class="simple">
<li><p>BFGS(no boundary)</p></li>
<li><p>L-BFGS-B(with boundary)</p></li>
</ul>
</dd>
</dl>
</li>
</ol>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>self</strong> (<em>Quasi_harmonic</em>)</p>
</dd>
</dl>
<p><strong>New Attributes</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">self.temperature</span></code> in K and <code class="docutils literal notranslate"><span class="pre">self.pressure</span></code> in GPa.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">self.equilibrium_volume</span></code>, nPressure*nTemperature. Equilibrium volumes. Unit: Angstrom^3</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">self.helmholtz</span></code> and <code class="docutils literal notranslate"><span class="pre">self.gibbs</span></code>, nPressure*nTemperature. Helmholtz and Gibbs free energies. Unit: kJ/mol</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">self.entropy</span></code>, nPressure*nTemperature, Entropy. Unit: J/mol*K</p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>ValueError</strong> – If temperature or pressure is defined neither here nor during initialization.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="crystalpytools.plot.html" class="btn btn-neutral float-left" title="CRYSTALpytools.plot module" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023CRYSTALpytools Development Team.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>